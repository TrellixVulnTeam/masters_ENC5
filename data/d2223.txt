Man who con­fessed to killing five peo­ple in a bow-and-ar­row at­tack was ‘in and out of the health sys­tem for some time’.