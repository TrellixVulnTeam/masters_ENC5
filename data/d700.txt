Britain’s Parliament voted resoundingly on Wednesday to approve a trade deal with the European Union, paving the way for an orderly break with the bloc that will finally complete the U.K.’s long and divisive Brexit journey.

With just a day to spare, lawmakers in the House of Commons voted 521-73 in favor of the agreement sealed between the U.K. government and the EU last week.

Brexit enthusiasts in Parliament praised it as a reclamation of independence from the bloc. Pro-Europeans lamented its failure to preserve seamless trade with Britain's biggest economic partner. But the vast majority in the divided Commons agreed that it was better than the alternative of a chaotic rupture with the EU.

Late Wednesday evening, Parliament's upper chamber, the unelected House of Lords, also backed the deal. It will become British law within hours, once it has received the formality of royal assent from Queen Elizabeth II.

The U.K. left the EU almost a year ago, but remained within the bloc’s economic embrace during a transition period that ends at midnight Brussels time —- 11 p.m. in London — on Thursday.

The day before departure, European Commission President Ursula von der Leyen and European Council President Charles Michel signed the hard-won agreement during a brief ceremony in Brussels.

“The agreement that we signed today is the result of months of intense negotiations in which the European Union has displayed an unprecedented level of unity,” Michel said. “It is a fair and balanced agreement that fully protects the fundamental interests of the European Union and creates stability and predictability for citizens and companies.”

The documents were then flown by Royal Air Force plane to London, where Prime Minister Boris Johnson added his signature in a photo opportunity in front of a row of Union Jack flags.

The European Parliament also must sign off on the agreement, but is not expected to get to it for several weeks.

Johnson told legislators that the deal heralded “a new relationship between Britain and the EU as sovereign equals.”

It has been 4 1/2 years since Britain voted 52% to 48% to leave the bloc it had joined in 1973. Brexit started on Jan. 31 of this year, but the real repercussions of that decision have yet to be felt, since the U.K.’s economic relationship with the EU remained unchanged during the 11-month transition period that ends Dec. 31.

Big changes are coming on New Year’s Day. The agreement, hammered out after more than nine months of tense negotiations and sealed on Christmas Eve, will ensure Britain and the 27-nation EU can continue to trade in goods without tariffs or quotas. That should help protect the 660 billion pounds ($894 billion) in annual trade between the two sides, and the hundreds of thousands of jobs that rely on it.

But the end to Britain’s membership in the EU’s vast single market and customs union will still bring inconvenience and new expense for both individuals and businesses — from the need for tourists to have travel insurance to the millions of new customs declarations that firms will have to fill out.

Brexit supporters, including Johnson, say any short-term pain will be worth it.

Johnson said the Brexit deal would turn Britain from “a half-hearted, sometimes obstructive member of the EU” into “a friendly neighbor — the best friend and ally the EU could have.”

He said Britain would now “trade and cooperate with our European neighbors on the closest terms of friendship and goodwill, whilst retaining sovereign control of our laws and our national destiny.”

Some lawmakers grumbled about being given only five hours in Parliament to scrutinize a 1,200-page deal that will mean profound changes for Britain’s economy and society. But support among legislators —- most of whom debated and voted from home because of virus restrictions — was overwhelming, if not always enthusiastic.

The powerful euroskeptic wing of Johnson's Conservative Party, which fought for years for the seemingly longshot goal of taking Britain out of the EU, gave its backing to the deal.

The strongly pro-EU Scottish National Party and Liberal Democrats and Northern Ireland's Democratic Unionist Party voted against. But the main opposition Labour Party, which had sought a closer relationship with the bloc, said it would vote for the agreement because even a thin deal was better than a chaotic no-deal rupture.

“We have only one day before the end of the transition period, and it’s the only deal that we have," said Labour leader Keir Starmer. "It’s a basis to build on in the years to come.”

Former Conservative Prime Minister Theresa May, who resigned in 2019 after three years of Brexit acrimony in Parliament, said she would vote for Johnson's agreement. But she said it was worse than the one she had negotiated with the bloc, which lawmakers repeatedly rejected.

She noted that the deal protected trade in goods but did not cover services, which account for 80% of Britain's economy.

“We have a deal in trade, which benefits the EU, but not a deal in services, which would have benefitted the U.K.," May said.